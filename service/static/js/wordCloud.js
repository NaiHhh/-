$ = layui.jquery;

function wordCloud() {
    let cid = $('input[name="cid"]').val();
    $.ajax({
    //几个参数需要注意一下
        type: "POST",//方法类型
        contentType: "application/json;charset=utf-8",
        url: "http://127.0.0.1:5000/wordCloud" ,//url
        data: '{"cid":"' + cid + '"}',
        success: function (result) {
            result = JSON.parse(result);
            if(result.code===200){
                chuli(result.data)
            }else{
                alert("请输入正确的cid");
            }
        }
    });
}

function chuli(jsonlist) {
    var mycharts = echarts.init(document.getElementById("main"));
    //用来存储数据
    console.log("==============")
    console.log(jsonlist)
    console.log("==============")
    // 人像的base64编码
    image1= "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABIAAAAKICAIAAACHSRZaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAABOlSURBVHhe7dehEQNBEAPBzz/pMxETVS1xdwjD5nsAAACcMGAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABw5GjAPgAA4G9kAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKAQMAAMayARQDBgAAjGUDKAYMAAAYywZQDBgAADCWDaAYMAAAYCwbQDFgAADAWDaAYsAAAICxbADFgAEAAGPZAIoBAwAAxrIBFAMGAACMZQMoBgwAABjLBlAMGAAAMJYNoBgwAABgLBtAMWAAAMBYNoBiwAAAgLFsAMWAAQAAY9kAigEDAADGsgEUAwYAAIxlAygGDAAAGMsGUAwYAAAwlg2gGDAAAGAsG0AxYAAAwFg2gGLAAACAsWwAxYABAABj2QCKNAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAARwwYAADAEQMGAABwxIABAAAcMWAAAABHDBgAAMARAwYAAHDEgAEAABwxYAAAAEcMGAAAwBEDBgAAcMSAAQAAHDFgAAAAJ977AeZrb+L0xkGsAAAAAElFTkSuQmCC"
    var maskResource = new Image()
    maskResource.src=image1;
    var option ={
        //设置标题，居中显示
        title:{
            text: '弹幕词云',
            left:'center',
         },
        //数据可以点击
        tooltip:{

        },

        series:[
            {
                maskImage:maskResource,
                //词的类型
                type: 'wordCloud',
                //设置字符大小范围
                sizeRange:[6,78],
                rotationRange:[-45,90],
                textStyle: {
                    normal:{
                        //生成随机的字体颜色
                        color:function () {
                            return 'rgb(' + [
                                Math.round(Math.random() * 160),
                                Math.round(Math.random() * 160),
                                Math.round(Math.random() * 160)
                            ].join(',')+')';

                        }
                    }

                },
                //不要忘记调用数据
                   data:jsonlist

             }
        ]

    };
    //加载图像，将数据放在图像中
    maskResource.onload = function(){
        mycharts.setOption(option)
    };
}

window.onload=function (){
    $('input[name="cid"]').val(88848456);
    wordCloud(88848456)
}

